<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <link rel="icon" type="image/jpeg" sizes="80x80" href="logo.jpg"/>
    <title>CDN Index Page</title>
    <style type="text/css">
        .yh-content > div {
            max-height: 500px;
            overflow-y: auto;
        }
    </style>
</head>
<body>

<div id="app">

    <nav class="navbar navbar-dark bg-dark">
        <div class="align-items-center">
            <a class="navbar-brand" href="#">
                CDN Index
            </a>
        </div>
        <div class="form-inline my-2 my-lg-0">
            <button @click="refresh" type="button" class="btn btn-link">
                <i class="fa fa-2x fa-refresh text-light link mr-2"></i>
            </button>
        </div>
    </nav>

    <div class="p-3 d-md-flex justify-content-around flex-wrap yh-content">

        <div class="card h-100 my-3">
            <div class="card-header">Templates</div>
            <div class="card-body">
                <ul>
                    <li v-for="tpl in cfg.templates">
                        <a target="_blank" :href="'templates/'+tpl">{{'templates/' + tpl}}</a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="card h-100 my-3">
            <div class="card-header">JSLibs</div>
            <div class="card-body">
                <ul>
                    <li v-for="jsLib in cfg.jsLibs">
                        <a target="_blank" :href="jsLib.link">{{jsLib.name}}</a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="card h-100 my-3">
            <div class="card-header">Icons</div>
            <div class="card-body">
                <ul>
                    <li v-for="icon in cfg.icons">
                        <a target="_blank" :href="icon.link">{{icon.name}}</a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="card h-100 my-3">
            <div class="card-header">CDN Files Tree</div>
            <div class="card-body">
                <pre v-html="fileTree"></pre>
            </div>
        </div>
    </div>

</div>

<script src="vue/vue.min.js"></script>
<script src="axios.min.js"></script>
<script src="common.js"></script>
<link href="font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="bootswatch/bootstrap.sketchy.min.css" rel="stylesheet">
<script>

    new Vue({
        el: "#app",
        data() {
            return {
                cfg: {},
                fileTree: ""
            }
        },
        methods: {
            refresh() {
                let result = confirm("确认重新加载？");
                if (result) {
                    this.cfg = {};
                    this.fileTree = "";
                    this.loadCfg(true);
                    this.loadFileTree(true);
                }
            },
            loadCfg(refresh = false) {
                common.getContent("json/cdn.cfg.json", refresh).then(cfgJson => {
                    console.log(cfgJson);
                    this.cfg = JSON.parse(cfgJson);
                });
            },
            loadFileTree(refresh = false) {
                common.getContent("json/cdn.fileTree.txt", refresh).then(data => {
                    this.fileTree = data;
                });
            },
        },
        mounted() {
            this.loadCfg();
            this.loadFileTree();
        }
    })

</script>

</body>
</html>
