define(["jquery","semantic","utils","gitee","axios"],(function($,semantic,utils,gitee,axios){return{data:()=>({username:"",password:"",loginState:{}}),methods:{login(){return""===this.username.trim()||""===this.password.trim()?(utils.message("请输入用户名密码！","warning"),!1):(axios.post("https://gitee.com/oauth/token",{grant_type:"password",username:this.username,password:this.password,client_id:gitee.apiConfig.client_id,client_secret:gitee.apiConfig.client_secret,scope:"projects"}).then(data=>{localStorage.setItem(gitee.storageKey.lsLoginState,JSON.stringify(data)),gitee.initState().then(()=>{utils.notify("登录成功","success"),this.$router.go(-1)}),this.username="",this.password=""}).catch(err=>{console.log(err),utils.notify("登录失败","error")}),!1)},loginValid(){gitee.refreshToken(data=>{this.loginState=data})}},mounted(){this.loginValid()},template:'\n            <div class="ui middle aligned center aligned grid flex-grow-1 rounded-0 p-2 m-0 wyd-home">\n              <div class="column border border-secondary rounded" style="max-width: 450px">\n                <h1 class="ui teal image header">\n                  <div class="content">\n                     请登录 <i class="sign in alternate icon"></i>\n                  </div>\n                </h1>\n                <div class="ui large form">\n                  <div class="ui stacked">\n                    <div class="field">\n                      <div class="ui left icon input">\n                        <i class="user icon"></i>\n                        <input @keyup.enter="login" type="text" name="username" placeholder="用户名" v-model="username">\n                      </div>\n                    </div>\n                    <div class="field">\n                      <div class="ui left icon input">\n                        <i class="lock icon"></i>\n                        <input @keyup.enter="login" type="password" name="password" placeholder="密码" v-model="password">\n                      </div>\n                    </div>\n                    <div class="ui fluid large teal submit button" @click="login">登录</div>\n                    <div class="mt-3" v-if="loginState.access_token">\n                        <div class="text-success my-3">已有登录状态</div>\n                        <div class="text-left mb-2">登录时间 => {{new Date(loginState.created_at*1000).toLocaleString()}}</div>\n                        <div class="text-left mb-2">过期时间 => {{new Date((loginState.created_at+loginState.expires_in)*1000).toLocaleString()}}</div>\n                        <div class="text-left mb-2 text-truncate">AccessToken => {{loginState.access_token}}</div>\n                        <div class="text-left mb-2 text-truncate">RefreshToken => {{loginState.refresh_token}}</div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n        '}}));