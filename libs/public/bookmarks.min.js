define(["gitee"],(function(e){let t=[],i=[],s=[];function a(e,t,h){if(e.a)for(let s of e.a)s.a?(i.push({name:s.b,type:t}),a(s,t,s.b)):a(s,t,h);else e.c&&(t&&(e.type=t),h&&(e.tag=h),s.push(e))}return{name:"bookmarks",data:()=>({bmTypeList:[],bmTagList:[],bmList:[],checkedType:"",checkedTag:"",searchTxt:"",loading:!1,bmSourceFilePath:"",bmSourceFile:{},bmSourceFiles:[]}),watch:{checkedType(e){this.checkedTag="",this.bmTagList=i.filter((t=>t.type===e)),this.bmList=s.filter((t=>t.type===e))}},methods:{initSearch(){$(".ui.search").search({source:[{title:"test",actionUrl:"https://zijieke.com/semantic-ui/modules/search.php#/settings"}],minCharacters:0,selectFirstResult:!0,onSelect(e,t){}})},logout(){confirm("确认登出？")&&(localStorage.clear(),window.location.href="/login.html")},search(){""===this.searchTxt?this.bmList=s.filter((e=>e.type===this.checkedType)):this.bmList=s.filter((e=>-1!==e.b.toUpperCase().indexOf(this.searchTxt.toUpperCase())||-1!==e.c.toUpperCase().indexOf(this.searchTxt.toUpperCase()))),this.checkedTag="",this.searchTxt=""},typeClick(e){this.bmList=s.filter((t=>t.type===e))},tagClick(e){let t=e.name;e.name===this.checkedTag&&(this.checkedTag="",t=""),this.checkedTag=t,this.bmList=""!==t?s.filter((e=>!!e.tag&&e.tag===t)):s.filter((e=>e.type===this.checkedType))},refreshData(){return confirm("确认重新下载书签数据?")&&(this.checkedType="",this.checkedTag="",s=[],t=[],i=[],this.bmTypeList=[],this.bmTagList=[],this.bmList=[],this.loadData(!0,this.bmSourceFile)),!1},loadData(t,i,s){e.getFileContent(i.path,t,!0,i.repo).then((e=>{this.bmDataHandle(e),s()}))},bmDataHandle(e){let h=e.a;for(let e of h)e.a?(a(e,e.b,null),t.push(e.b)):a(e,null,null);this.checkedType=t[0],this.bmTypeList=t,this.bmTagList=i,this.bmList=s,this.loading=!1},changeSource(e){e.path!==this.bmSourceFilePath&&(t=[],i=[],s=[],this.loadData(!1,e,(()=>{this.bmSourceFile=e,this.bmSourceFilePath=e.path})))}},mounted(){t=[],i=[],s=[];let a=e.getWydConfig();a&&a.bookmarksChrome&&(this.bmSourceFiles=a.bookmarksChrome.bmSourceFiles,this.changeSource(this.bmSourceFiles[0]))},template:document.querySelector("#layout #bookmarks")}}));