initApp().then((()=>{let t=[],e=[],i=[];function a(t,s,h){if(t.a)for(let i of t.a)i.a?(e.push({name:i.b,type:s}),a(i,s,i.b)):a(i,s,h);else t.c&&(s&&(t.type=s),h&&(t.tag=h),i.push(t))}new Vue({el:"#root",data(){return{bmTypeList:[],bmTagList:[],bmList:[],checkedType:"",checkedTag:"",searchTxt:"",loading:!1,actions:[{title:"下载书签",call:()=>{this.refreshData()}}]}},watch:{checkedType(t){this.checkedTag="",this.bmTagList=e.filter((e=>e.type===t)),this.bmList=i.filter((e=>e.type===t))}},methods:{logout(){confirm("确认登出？")&&(localStorage.clear(),window.location.href="/login.html")},search(){this.bmList=i.filter((t=>-1!==t.b.toUpperCase().indexOf(this.searchTxt.toUpperCase())||-1!==t.c.toUpperCase().indexOf(this.searchTxt.toUpperCase()))),this.checkedTag="",this.searchTxt=""},typeClick(t){this.bmList=i.filter((e=>e.type===t))},tagClick(t){let e=t.name;t.name===this.checkedTag&&(this.checkedTag="",e=""),this.bmList=""!==e?i.filter((t=>!!t.tag&&t.tag===e)):i.filter((t=>t.type===this.checkedType))},refreshData(){return confirm("确认重新下载书签数据？")&&(this.loading=!0,this.checkedType="",this.checkedTag="",i=[],t=[],e=[],this.bmTypeList=[],this.bmTagList=[],this.bmList=[],this.loadData(!0),setTimeout((()=>{this.loading=!1}),3e3)),!1},loadData(t){common.getContent("json/chrome.bookmark.json",t).then((t=>{this.bmDataHandle(t)}))},bmDataHandle(s){let h=JSON.parse(s).a;for(let e of h)e.a?(a(e,e.b,null),t.push(e.b)):a(e,null,null);this.checkedType=t[0],this.bmTypeList=t,this.bmTagList=e,this.bmList=i,this.loading=!1}},mounted(){this.loadData()}})}));